# ì•½ ë³µìš© ì‹œê°„ ì¶”ì²œ ì„œë¹„ìŠ¤ - Cursor Rules

## í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸

ì´ í”„ë¡œì íŠ¸ëŠ” ìƒì²´ë¦¬ë“¬ ê¸°ë°˜ ì•½ ë³µìš© ì‹œê°„ ì¶”ì²œì„ ì œê³µí•˜ëŠ” í—¬ìŠ¤ì¼€ì–´ ì •ë³´ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.
- **ëª©ì **: ì‚¬ìš©ìê°€ ì•½ë¬¼ì— ëŒ€í•´ ì´í•´í•˜ê³  ì•ˆì „í•œ ë³µìš© ìŠµê´€ì„ í˜•ì„±í•˜ë„ë¡ ë•ëŠ” ì •ë³´ ì œê³µ
- **íŠ¹ì„±**: ì˜ë£Œ í–‰ìœ„ê°€ ì•„ë‹Œ ì°¸ê³  ì •ë³´ ì œê³µ
- **ëŒ€ìƒ**: ì „ ì—°ë ¹ì¸µ (íŠ¹íˆ ì¤‘ì¥ë…„ì¸µ ë° ë…¸ë…„ì¸µ ê³ ë ¤)

## ê¸°ìˆ  ìŠ¤íƒ (2026 ìµœì‹  ë²„ì „)

### Core
- Next.js 15.5.9 (App Router)
- React 19.2.3 (Server Components ìš°ì„ )
- TypeScript 5.9 (strict mode)
- Node.js 20.x LTS

### Backend & Database
- Prisma 7.2.0 (ORM)
- Vercel Postgres (Neon Serverless)
- NextAuth.js 4.24.13 (ì¸ì¦)

### Frontend & Styling
- Tailwind CSS 4.1.18
- Radix UI (ì ‘ê·¼ì„± ì»´í¬ë„ŒíŠ¸)
- Heroicons (ì•„ì´ì½˜)

### State & Data Fetching
- Zustand v5 (ì „ì—­ ìƒíƒœ)
- SWR 2.x (ë°ì´í„° í˜ì¹­)
- React Hook Form 7.x + Zod 3.x (í¼ ê´€ë¦¬)

### Utils
- date-fns 3.x (ë‚ ì§œ ì²˜ë¦¬)
- Axios 1.x (HTTP í´ë¼ì´ì–¸íŠ¸)
- bcryptjs (ë¹„ë°€ë²ˆí˜¸ í•´ì‹±)

---

## ì½”ë“œ ìŠ¤íƒ€ì¼ & êµ¬ì¡°

### TypeScript ê·œì¹™

```typescript
// âœ… GOOD: Interface ì‚¬ìš© (props, API ìŠ¤í‚¤ë§ˆ)
interface MedicineCardProps {
  medicine: Medicine;
  onClick?: () => void;
  isLoading?: boolean;
}

// âŒ BAD: Type alias ì‚¬ìš© (ê³µê°œ APIì—ëŠ” interface ì„ í˜¸)
type MedicineCardProps = {
  medicine: Medicine;
  onClick?: () => void;
}

// âœ… GOOD: Const object ì‚¬ìš© (enum ëŒ€ì‹ )
const TimeSlot = {
  MORNING: 'MORNING',
  AFTERNOON: 'AFTERNOON',
  EVENING: 'EVENING',
  BEDTIME: 'BEDTIME',
} as const;
type TimeSlot = typeof TimeSlot[keyof typeof TimeSlot];

// âŒ BAD: Enum ì‚¬ìš© í”¼í•˜ê¸°
enum TimeSlot {
  MORNING = 'MORNING',
  AFTERNOON = 'AFTERNOON',
}
```

### Naming Conventions

- **ë³€ìˆ˜/í•¨ìˆ˜**: camelCase (`isLoading`, `fetchMedicines`, `hasError`)
- **ì»´í¬ë„ŒíŠ¸**: PascalCase (`MedicineCard`, `TimelineView`)
- **ìƒìˆ˜**: UPPER_SNAKE_CASE (`API_BASE_URL`, `MAX_RETRY_COUNT`)
- **íŒŒì¼ëª…**: kebab-case for routes (`user-medicines/page.tsx`)
- **ì»´í¬ë„ŒíŠ¸ íŒŒì¼**: PascalCase (`Button.tsx`, `MedicineCard.tsx`)
- **ë””ë ‰í† ë¦¬**: lowercase-with-dashes (`components/medicine-card/`)

### File Organization

```typescript
// ì»´í¬ë„ŒíŠ¸ íŒŒì¼ ìˆœì„œ:
// 1. Imports
// 2. Types/Interfaces
// 3. Main exported component
// 4. Subcomponents
// 5. Helper functions
// 6. Constants/static content

import { Medicine } from '@/types/medicine';
import { Button } from '@/components/ui/Button';

interface MedicineCardProps {
  medicine: Medicine;
}

export function MedicineCard({ medicine }: MedicineCardProps) {
  return (
    <div>
      <MedicineHeader medicine={medicine} />
      <MedicineBody medicine={medicine} />
    </div>
  );
}

function MedicineHeader({ medicine }: { medicine: Medicine }) {
  return <h3>{medicine.itemName}</h3>;
}

function MedicineBody({ medicine }: { medicine: Medicine }) {
  return <p>{medicine.mainIngrName}</p>;
}

const CARD_STYLES = 'p-4 rounded-lg border';
```

---

## React & Next.js íŒ¨í„´

### Server Components ìš°ì„  ì‚¬ìš©

```typescript
// âœ… GOOD: Server Component (ê¸°ë³¸)
// app/medicines/page.tsx
import { prisma } from '@/lib/prisma';

export default async function MedicinesPage() {
  const medicines = await prisma.medicine.findMany();
  
  return (
    <div>
      {medicines.map(medicine => (
        <MedicineCard key={medicine.id} medicine={medicine} />
      ))}
    </div>
  );
}

// âœ… GOOD: Client Component (ì¸í„°ë™ì…˜ í•„ìš”ì‹œì—ë§Œ)
'use client';

import { useState } from 'react';

export function InteractiveMedicineCard({ medicine }: Props) {
  const [liked, setLiked] = useState(false);
  
  return (
    <button onClick={() => setLiked(!liked)}>
      {liked ? 'â¤ï¸' : 'ğŸ¤'}
    </button>
  );
}

// âŒ BAD: ë¶ˆí•„ìš”í•œ 'use client'
'use client';

export function StaticMedicineInfo({ medicine }: Props) {
  return <div>{medicine.itemName}</div>; // ìƒíƒœ ì—†ìŒ, ì„œë²„ì—ì„œ ë Œë” ê°€ëŠ¥
}
```

### Minimize useEffect & useState

```typescript
// âœ… GOOD: Server-side data fetching
async function MedicineDetail({ params }: { params: { id: string } }) {
  const medicine = await prisma.medicine.findUnique({
    where: { id: params.id }
  });
  
  return <MedicineInfo medicine={medicine} />;
}

// âŒ BAD: Client-side useEffect fetching
'use client';
function MedicineDetail({ id }: { id: string }) {
  const [medicine, setMedicine] = useState(null);
  
  useEffect(() => {
    fetch(`/api/medicines/${id}`)
      .then(res => res.json())
      .then(setMedicine);
  }, [id]);
  
  return medicine ? <MedicineInfo medicine={medicine} /> : <Loading />;
}

// âœ… GOOD: SWRë¡œ í´ë¼ì´ì–¸íŠ¸ ë°ì´í„° í•„ìš”ì‹œ
'use client';
import useSWR from 'swr';

function MedicineLiveData({ id }: { id: string }) {
  const { data, error, isLoading } = useSWR(`/api/medicines/${id}/live`);
  
  if (isLoading) return <Loading />;
  if (error) return <Error />;
  return <LiveInfo data={data} />;
}
```

### Error & Loading States

```typescript
// app/medicines/[id]/loading.tsx
export default function Loading() {
  return <MedicineDetailSkeleton />;
}

// app/medicines/[id]/error.tsx
'use client';

export default function Error({
  error,
  reset,
}: {
  error: Error & { digest?: string };
  reset: () => void;
}) {
  return (
    <div className="alert-danger">
      <h2>ì•½ë¬¼ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</h2>
      <p>{error.message}</p>
      <button onClick={reset} className="btn-primary">
        ë‹¤ì‹œ ì‹œë„
      </button>
    </div>
  );
}
```

### Early Returns & Guard Clauses

```typescript
// âœ… GOOD: Early returns
export function MedicineCard({ medicine }: Props) {
  if (!medicine) return null;
  if (!medicine.itemName) return <EmptyCard />;
  
  return (
    <div className="card">
      <h3>{medicine.itemName}</h3>
      <p>{medicine.mainIngrName}</p>
    </div>
  );
}

// âŒ BAD: Nested conditions
export function MedicineCard({ medicine }: Props) {
  return (
    <div>
      {medicine ? (
        medicine.itemName ? (
          <div className="card">
            <h3>{medicine.itemName}</h3>
            <p>{medicine.mainIngrName}</p>
          </div>
        ) : (
          <EmptyCard />
        )
      ) : null}
    </div>
  );
}
```

---

## ë””ìì¸ ì‹œìŠ¤í…œ (Tailwind)

### Color System

```typescript
// tailwind.config.tsì— ì •ì˜ëœ ì»¤ìŠ¤í…€ ì»¬ëŸ¬ ì‚¬ìš©
// âœ… GOOD: Semantic colors
<button className="bg-primary text-white hover:bg-primary-hover">
  ì €ì¥í•˜ê¸°
</button>

<div className="alert-warning">
  âš ï¸ ì£¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤
</div>

// Primary: #7FA99B (ì„¸ì´ì§€ ê·¸ë¦°)
// Success: #9CAF88 (ì˜¬ë¦¬ë¸Œ ê·¸ë¦°)
// Warning: #E8A87C (ë³µìˆ­ì•„ ì˜¤ë Œì§€)
// Danger: #D48A88 (ë¶€ë“œëŸ¬ìš´ ì½”ë„)
// Info: #8FA9C9 (ë¶€ë“œëŸ¬ìš´ ë¸”ë£¨)

// âŒ BAD: ì§ì ‘ hex ìƒ‰ìƒ ì‚¬ìš©
<button className="bg-[#7FA99B]">ë²„íŠ¼</button>
```

### Component Classes

```typescript
// âœ… GOOD: ì¬ì‚¬ìš© ê°€ëŠ¥í•œ í´ë˜ìŠ¤ í™œìš©
<button className="btn btn-primary">
  ë³µìš© ì‹œê°„ ì¶”ì²œ ë°›ê¸°
</button>

<div className="card card-hover">
  <h3 className="text-xl font-bold">íƒ€ì´ë ˆë†€</h3>
</div>

<div className="input">
  <input type="text" placeholder="ì•½ ì´ë¦„ ê²€ìƒ‰" />
</div>

// globals.cssì— ì •ì˜:
// .btn, .btn-primary, .btn-secondary, .btn-danger
// .card, .card-hover
// .input, .alert, .alert-info, .alert-warning
```

### Responsive Design

```typescript
// âœ… GOOD: Mobile-first approach
<div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
  {medicines.map(medicine => (
    <MedicineCard key={medicine.id} medicine={medicine} />
  ))}
</div>

// Container widths
<div className="container mx-auto px-4 md:px-8 lg:px-12 max-w-7xl">
  {children}
</div>
```

---

## Prisma & Database Patterns

### Query Optimization

```typescript
// âœ… GOOD: Includeë¡œ N+1 ë¬¸ì œ í•´ê²°
const users = await prisma.user.findMany({
  include: {
    userMedicines: {
      include: {
        medicine: true,
      },
    },
  },
});

// âŒ BAD: N+1 problem
const users = await prisma.user.findMany();
for (const user of users) {
  const medicines = await prisma.userMedicine.findMany({
    where: { userId: user.id },
  });
}

// âœ… GOOD: Selectë¡œ í•„ìš”í•œ í•„ë“œë§Œ ì¡°íšŒ
const medicine = await prisma.medicine.findUnique({
  where: { id },
  select: {
    id: true,
    itemName: true,
    mainIngrName: true,
    sleepInducing: true,
  },
});
```

### Error Handling

```typescript
// âœ… GOOD: Try-catchë¡œ ê°ì‹¸ê¸°
export async function GET(request: NextRequest) {
  try {
    const medicines = await prisma.medicine.findMany();
    return NextResponse.json({ medicines });
  } catch (error) {
    console.error('Database error:', error);
    return NextResponse.json(
      { error: 'ì•½ë¬¼ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.' },
      { status: 500 }
    );
  }
}
```

### Connection Management

```typescript
// lib/prisma.ts - Singleton pattern
import { PrismaClient } from '@prisma/client';

const globalForPrisma = globalThis as unknown as {
  prisma: PrismaClient | undefined;
};

export const prisma =
  globalForPrisma.prisma ??
  new PrismaClient({
    log: process.env.NODE_ENV === 'development' ? ['query', 'error'] : ['error'],
  });

if (process.env.NODE_ENV !== 'production') {
  globalForPrisma.prisma = prisma;
}
```

---

## API Routes íŒ¨í„´

### Standard Structure

```typescript
// app/api/medicines/[id]/route.ts
import { NextRequest, NextResponse } from 'next/server';
import { getServerSession } from 'next-auth';
import { authOptions } from '@/lib/auth';
import { prisma } from '@/lib/prisma';

export async function GET(
  request: NextRequest,
  { params }: { params: { id: string } }
) {
  try {
    // 1. ì¸ì¦ í™•ì¸ (í•„ìš”ì‹œ)
    const session = await getServerSession(authOptions);
    if (!session) {
      return NextResponse.json(
        { error: 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.' },
        { status: 401 }
      );
    }

    // 2. ì…ë ¥ ê²€ì¦
    if (!params.id) {
      return NextResponse.json(
        { error: 'IDê°€ í•„ìš”í•©ë‹ˆë‹¤.' },
        { status: 400 }
      );
    }

    // 3. ë°ì´í„° ì¡°íšŒ
    const medicine = await prisma.medicine.findUnique({
      where: { id: params.id },
    });

    if (!medicine) {
      return NextResponse.json(
        { error: 'ì•½ë¬¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.' },
        { status: 404 }
      );
    }

    // 4. ì‘ë‹µ ë°˜í™˜
    return NextResponse.json({ medicine });
  } catch (error) {
    console.error('API error:', error);
    return NextResponse.json(
      { error: 'ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.' },
      { status: 500 }
    );
  }
}
```

### Response Format

```typescript
// âœ… GOOD: Consistent response structure
return NextResponse.json({
  success: true,
  data: { medicine },
  message: 'ì¡°íšŒ ì„±ê³µ',
});

// Error response
return NextResponse.json({
  success: false,
  error: {
    code: 'MEDICINE_NOT_FOUND',
    message: 'ì•½ë¬¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.',
  },
}, { status: 404 });
```

---

## í—¬ìŠ¤ì¼€ì–´ íŠ¹ìˆ˜ ê·œì¹™

### í‘œí˜„ ê°€ì´ë“œë¼ì¸

```typescript
// âœ… GOOD: ì™„í™” í‘œí˜„ ì‚¬ìš©
const recommendation = {
  timeSlot: 'MORNING',
  reason: 'ì¼ë°˜ì ìœ¼ë¡œ ì´ ì•½ì€ ì•„ì¹¨ ì‹œê°„ëŒ€ ë³µìš©ì´ ê³ ë ¤ë˜ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤.',
  note: 'ê°œì¸ì˜ ìƒí™œ íŒ¨í„´ì— ë”°ë¼ ì˜ë£Œì§„ì´ ë³µìš© ì‹œê°„ì„ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
};

// âŒ BAD: í™•ì •ì  í‘œí˜„
const recommendation = {
  reason: 'ì´ ì•½ì€ ë°˜ë“œì‹œ ì•„ì¹¨ì— ë“œì…”ì•¼ í•©ë‹ˆë‹¤.',
  note: 'ì €ë… 8ì‹œì— ë³µìš©í•˜ì‹­ì‹œì˜¤.',
};

// âœ… GOOD: í•„ìˆ˜ í‘œí˜„
const warningWords = [
  'ì¼ë°˜ì ìœ¼ë¡œ',
  '~í•œ ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤',
  '~ê²ƒìœ¼ë¡œ ì•Œë ¤ì ¸ ìˆìŠµë‹ˆë‹¤',
  'ì˜ë£Œì§„ íŒë‹¨ì— ë”°ë¼',
  'ê°œì¸ì°¨ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤',
  '~ê³ ë ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤',
];
```

### Disclaimer (ê³ ì§€ì‚¬í•­)

```typescript
// ëª¨ë“  ì•½ë¬¼ ì •ë³´ ë° ì¶”ì²œ í˜ì´ì§€ì— í•„ìˆ˜ í¬í•¨
export function DisclaimerBanner() {
  return (
    <div className="alert-warning my-6">
      <div className="flex gap-3">
        <span className="text-2xl">âš ï¸</span>
        <div>
          <h4 className="font-bold mb-2">ì¤‘ìš”</h4>
          <p>
            ì´ ì •ë³´ëŠ” ì¼ë°˜ì ì¸ ì°¸ê³ ìš© ì„¤ëª…ì…ë‹ˆë‹¤.
            ë³µìš© ì‹œê°„ ë³€ê²½ì´ë‚˜ ì¹˜ë£Œ ê²°ì •ì€ ë°˜ë“œì‹œ ì˜ì‚¬ ë˜ëŠ” ì•½ì‚¬ì™€ ìƒë‹´í•˜ì„¸ìš”.
          </p>
        </div>
      </div>
    </div>
  );
}

// íŠ¹ë³„ ì£¼ì˜ ì•½ë¬¼
export function CriticalMedicineWarning() {
  return (
    <div className="alert-danger my-6">
      <h4 className="font-bold mb-2">âš ï¸ï¸ íŠ¹ë³„ ì£¼ì˜</h4>
      <p>
        ì´ ì•½ì€ ë³µìš© ì‹œê°„ì´ íŠ¹íˆ ì¤‘ìš”í•  ìˆ˜ ìˆëŠ” ì•½ë¬¼ì…ë‹ˆë‹¤.
        ì˜ì‚¬ì˜ ì§€ì‹œë¥¼ ì •í™•íˆ ë”°ë¥´ì‹œê³ , ë³µìš© ì‹œê°„ ë³€ê²½ ì‹œ ë°˜ë“œì‹œ ì˜ë£Œì§„ê³¼ ìƒë‹´í•˜ì„¸ìš”.
        ì„ì˜ë¡œ ë³µìš© ì‹œê°„ì„ ë³€ê²½í•˜ê±°ë‚˜ ì¤‘ë‹¨í•˜ì§€ ë§ˆì„¸ìš”.
      </p>
    </div>
  );
}
```

### Accessibility (ì ‘ê·¼ì„±)

```typescript
// âœ… GOOD: ARIA labels, semantic HTML
<button
  aria-label="ì•½ ì‚­ì œ"
  className="btn-danger"
  onClick={handleDelete}
>
  <TrashIcon className="w-5 h-5" />
</button>

<input
  type="search"
  aria-label="ì•½ ì´ë¦„ ê²€ìƒ‰"
  placeholder="ì•½ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”"
  className="input"
/>

// ìµœì†Œ í„°ì¹˜ ì˜ì—­: 48x48px (ëª¨ë°”ì¼)
<button className="min-h-[48px] min-w-[48px] p-3">
  ë²„íŠ¼
</button>

// ìƒ‰ìƒ ëŒ€ë¹„: WCAG AA ê¸°ì¤€ (4.5:1)
// í…ìŠ¤íŠ¸ í¬ê¸°: ìµœì†Œ 14px, ë³¸ë¬¸ 16px
```

---

## ì„±ëŠ¥ ìµœì í™”

### Image Optimization

```typescript
// âœ… GOOD: Next.js Image component
import Image from 'next/image';

<Image
  src="/medicine.jpg"
  alt="íƒ€ì´ë ˆë†€ 500mg"
  width={400}
  height={300}
  loading="lazy"
  placeholder="blur"
/>

// âŒ BAD: Regular img tag
<img src="/medicine.jpg" alt="ì•½í’ˆ" />
```

### Dynamic Imports

```typescript
// âœ… GOOD: Code splitting for heavy components
import dynamic from 'next/dynamic';

const HeavyChart = dynamic(() => import('@/components/HeavyChart'), {
  loading: () => <ChartSkeleton />,
  ssr: false,
});

export default function Dashboard() {
  return (
    <div>
      <h1>ëŒ€ì‹œë³´ë“œ</h1>
      <HeavyChart />
    </div>
  );
}
```

### Memoization

```typescript
// âœ… GOOD: React.memo for expensive components
import { memo } from 'react';

export const MedicineCard = memo(function MedicineCard({ medicine }: Props) {
  return (
    <div className="card">
      <h3>{medicine.itemName}</h3>
      <p>{medicine.mainIngrName}</p>
    </div>
  );
});

// useMemo for expensive calculations
import { useMemo } from 'react';

function MedicineSchedule({ medicines, pattern }: Props) {
  const schedule = useMemo(() => {
    return generateSchedule(medicines, pattern);
  }, [medicines, pattern]);
  
  return <Timeline schedule={schedule} />;
}
```

---

## Form Validation (Zod)

```typescript
// âœ… GOOD: Zod schema for validation
import { z } from 'zod';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';

const lifePatternSchema = z.object({
  wakeTime: z.string().regex(/^([01]\d|2[0-3]):([0-5]\d)$/, 'ì˜¬ë°”ë¥¸ ì‹œê°„ í˜•ì‹ì„ ì…ë ¥í•˜ì„¸ìš”'),
  sleepTime: z.string().regex(/^([01]\d|2[0-3]):([0-5]\d)$/),
  breakfastTime: z.string().optional(),
  drivesOften: z.boolean().default(false),
  needsConcentration: z.boolean().default(false),
});

type LifePatternForm = z.infer<typeof lifePatternSchema>;

export function LifePatternForm() {
  const {
    register,
    handleSubmit,
    formState: { errors },
  } = useForm<LifePatternForm>({
    resolver: zodResolver(lifePatternSchema),
  });

  const onSubmit = async (data: LifePatternForm) => {
    await fetch('/api/patterns', {
      method: 'POST',
      body: JSON.stringify(data),
    });
  };

  return (
    <form onSubmit={handleSubmit(onSubmit)}>
      <input
        {...register('wakeTime')}
        className="input"
        placeholder="07:00"
      />
      {errors.wakeTime && (
        <span className="text-danger">{errors.wakeTime.message}</span>
      )}
      <button type="submit" className="btn-primary">ì €ì¥</button>
    </form>
  );
}
```

---

## Environment Variables

```bash
# .env.local (Gitì— í¬í•¨í•˜ì§€ ì•ŠìŒ)
POSTGRES_URL="postgres://..."
POSTGRES_PRISMA_URL="postgres://..."
NEXTAUTH_SECRET="your-secret-key"
MFDS_SERVICE_KEY="ì‹ì•½ì²˜-api-key"

# .env.example (Gitì— í¬í•¨)
POSTGRES_URL="postgres://username:password@host:5432/database"
NEXTAUTH_SECRET="generate-with: openssl rand -base64 32"
MFDS_SERVICE_KEY="your-api-key-from-data.go.kr"
```

```typescript
// âœ… GOOD: í™˜ê²½ ë³€ìˆ˜ ê²€ì¦
if (!process.env.NEXTAUTH_SECRET) {
  throw new Error('NEXTAUTH_SECRET is required');
}

// Type-safe access
const config = {
  database: {
    url: process.env.POSTGRES_URL!,
  },
  auth: {
    secret: process.env.NEXTAUTH_SECRET!,
  },
  api: {
    mfdsKey: process.env.MFDS_SERVICE_KEY!,
  },
} as const;
```

---

## SEO & Metadata (Next.js)

### Metadata API

```typescript
// âœ… GOOD: app/medicines/[id]/page.tsx
import type { Metadata } from 'next';

export async function generateMetadata(
  { params }: { params: { id: string } }
): Promise<Metadata> {
  const medicine = await prisma.medicine.findUnique({
    where: { id: params.id },
  });

  return {
    title: `${medicine?.itemName} - ë³µìš© ì‹œê°„ ì¶”ì²œ`,
    description: `${medicine?.itemName}ì˜ íš¨ëŠ¥, ë³µìš© ë°©ë²•, ìƒì²´ë¦¬ë“¬ ê¸°ë°˜ ì¶”ì²œ ì‹œê°„ì„ í™•ì¸í•˜ì„¸ìš”.`,
    openGraph: {
      title: medicine?.itemName,
      description: medicine?.mainIngrName,
      type: 'article',
    },
  };
}

// âœ… GOOD: Layout metadata
// app/layout.tsx
export const metadata: Metadata = {
  title: {
    default: 'ì•½ ë³µìš© ì‹œê°„ ì¶”ì²œ ì„œë¹„ìŠ¤',
    template: '%s | MediTime',
  },
  description: 'ìƒì²´ë¦¬ë“¬ ê¸°ë°˜ ê³¼í•™ì ì¸ ì•½ ë³µìš© ì‹œê°„ ê°€ì´ë“œ',
  keywords: ['ì•½ ë³µìš©', 'ë³µìš© ì‹œê°„', 'ìƒì²´ë¦¬ë“¬', 'ê±´ê°•'],
  authors: [{ name: 'MediTime Team' }],
  openGraph: {
    type: 'website',
    locale: 'ko_KR',
    siteName: 'MediTime',
  },
};
```

### Sitemap & Robots

```typescript
// app/sitemap.ts
import { MetadataRoute } from 'next';

export default function sitemap(): MetadataRoute.Sitemap {
  return [
    {
      url: 'https://meditime.com',
      lastModified: new Date(),
      changeFrequency: 'daily',
      priority: 1,
    },
    {
      url: 'https://meditime.com/medicines',
      lastModified: new Date(),
      changeFrequency: 'daily',
      priority: 0.8,
    },
  ];
}

// app/robots.ts
import { MetadataRoute } from 'next';

export default function robots(): MetadataRoute.Robots {
  return {
    rules: {
      userAgent: '*',
      allow: '/',
      disallow: ['/api/', '/dashboard/'],
    },
    sitemap: 'https://meditime.com/sitemap.xml',
  };
}
```

---

## Testing (ì„ íƒì‚¬í•­)

```typescript
// tests/unit/medicine.test.ts
import { describe, it, expect } from 'vitest';
import { generateRecommendation } from '@/services/recommendationService';

describe('Recommendation Service', () => {
  it('should recommend morning for stimulant medicines', () => {
    const medicine = {
      sleepInducing: 'NONE',
      alertnessEffect: 'HIGH',
    };
    const pattern = { wakeTime: '07:00', sleepTime: '23:00' };
    
    const result = generateRecommendation(medicine, pattern);
    
    expect(result.timeSlot).toBe('MORNING');
    expect(result.reason).toContain('ê°ì„±');
  });
});
```

---

## Git Commit Messages

```bash
# ê·œì¹™: <type>: <subject>
feat: add medicine recommendation API
fix: resolve authentication timeout issue
docs: update API documentation
style: format code with prettier
refactor: simplify medicine query logic
test: add recommendation service tests
chore: update dependencies

# âŒ BAD
git commit -m "update code"
git commit -m "fix bug"

# âœ… GOOD
git commit -m "feat: implement user life pattern settings"
git commit -m "fix: prevent duplicate medicine entries in schedule"
```

---

## Migration Path to .cursor/rules/

í–¥í›„ í”„ë¡œì íŠ¸ê°€ ì„±ì¥í•˜ë©´ ë‹¤ìŒ êµ¬ì¡°ë¡œ ì „í™˜ ê°€ëŠ¥:

```
.cursor/rules/
â”œâ”€â”€ global.mdc (ì „ì—­ ê·œì¹™)
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ components.mdc (ì»´í¬ë„ŒíŠ¸ ê·œì¹™)
â”‚   â”œâ”€â”€ styling.mdc (ìŠ¤íƒ€ì¼ ê·œì¹™)
â”‚   â””â”€â”€ accessibility.mdc (ì ‘ê·¼ì„±)
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ api.mdc (API íŒ¨í„´)
â”‚   â”œâ”€â”€ database.mdc (Prisma ê·œì¹™)
â”‚   â””â”€â”€ auth.mdc (ì¸ì¦)
â””â”€â”€ healthcare/
    â””â”€â”€ medical-content.mdc (ì˜ë£Œ ì½˜í…ì¸  ê·œì¹™)
```

---

**Version**: 1.0  
**Last Updated**: 2026-01-22  
**Project**: ì•½ ë³µìš© ì‹œê°„ ì¶”ì²œ ì„œë¹„ìŠ¤ (MediTime)

ì´ ê·œì¹™ì€ í”„ë¡œì íŠ¸ì˜ ë°œì „ê³¼ í•¨ê»˜ ì§€ì†ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.
